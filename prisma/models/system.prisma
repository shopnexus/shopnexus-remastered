// TODO: move to kafka or rabbitmq for better performance
model Event {
  id         BigInt  @id @default(autoincrement())
  account_id BigInt? // Who performed this event, can be null for system events

  aggregate_id   BigInt // The id of the aggregate root, e.g. Product.id, Order.id, etc.
  aggregate_type String   @db.VarChar(100) // e.g. Product, Order,
  event_type     String   @db.VarChar(100) // e.g. Created, Updated, Deleted
  payload        Json     @db.JsonB
  version        BigInt // Prevent duplicate events
  date_created   DateTime @default(now()) @db.Timestamptz(3)

  account Account? @relation(fields: [account_id], references: [id], onUpdate: Cascade, onDelete: SetNull)

  @@map("event")
  @@schema("system")
}
