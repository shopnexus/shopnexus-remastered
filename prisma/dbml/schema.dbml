//// ------------------------------------------------------
//// THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
//// ------------------------------------------------------

Table account {
  id BigInt [pk, increment]
  code String [unique, not null]
  type AccountType [not null]
  status AccountStatus [not null, default: 'ACTIVE']
  phone String [unique]
  email String [unique]
  username String [unique]
  password String
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [default: `now()`, not null]
}

Table profile {
  id BigInt [pk, increment]
  account_id BigInt [unique, not null]
  gender Gender
  name String
  date_of_birth DateTime
  avatar_rs_id BigInt [unique]
  email_verified Boolean [not null, default: false]
  phone_verified Boolean [not null, default: false]
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [default: `now()`, not null]
}

Table customer {
  id BigInt [pk, increment]
  account_id BigInt [unique, not null]
  default_address_id BigInt
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [default: `now()`, not null]
}

Table vendor {
  id BigInt [pk, increment]
  account_id BigInt [unique, not null]
}

Table cart_item {
  id BigInt [pk, increment]
  cart_id BigInt [not null]
  sku_id BigInt [not null]
  quantity BigInt [not null]
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [default: `now()`, not null]

  indexes {
    (cart_id, sku_id) [unique]
  }
}

Table address {
  id BigInt [pk, increment]
  code String [unique, not null]
  account_id BigInt [not null]
  type AddressType [not null, default: 'HOME']
  full_name String [not null]
  phone String [not null]
  phone_verified Boolean [not null, default: false]
  address_line String [not null]
  city String [not null]
  state_province String [not null]
  country String [not null]
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [default: `now()`, not null]
}

Table brand {
  id BigInt [pk, increment]
  code String [unique, not null]
  name String [not null]
  description String [not null]
}

Table category {
  id BigInt [pk, increment]
  name String [unique, not null]
  description String [not null, default: '']
  parent_id BigInt
}

Table product_spu {
  id BigInt [pk, increment]
  code String [unique, not null]
  account_id BigInt [not null]
  category_id BigInt [not null]
  brand_id BigInt [not null]
  name String [not null]
  description String [not null]
  is_active Boolean [not null, default: true]
  date_manufactured DateTime [not null]
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [default: `now()`, not null]
  date_deleted DateTime
}

Table product_sku {
  id BigInt [pk, increment]
  code String [unique, not null]
  spu_id BigInt [not null]
  price BigInt [not null]
  can_combine Boolean [not null, default: false]
  date_created DateTime [default: `now()`, not null]
  date_deleted DateTime
}

Table product_sku_attribute {
  id BigInt [pk, increment]
  code String [unique, not null]
  sku_id BigInt [not null]
  name String [not null]
  value String [not null]
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [default: `now()`, not null]
}

Table tag {
  id BigInt [pk, increment]
  tag String [unique, not null]
  description String [not null, default: '']
}

Table product_spu_tag {
  id BigInt [pk, increment]
  spu_id BigInt [not null]
  tag_id BigInt [not null]

  indexes {
    (spu_id, tag_id) [unique]
  }
}

Table comment {
  id BigInt [pk, increment]
  code String [unique, not null]
  account_id BigInt [not null]
  ref_type CommentableType [not null]
  ref_id BigInt [not null]
  body String [not null]
  upvote BigInt [not null, default: 0]
  downvote BigInt [not null, default: 0]
  score Int [not null, default: 0]
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [default: `now()`, not null]

  indexes {
    (account_id, ref_type, ref_id) [unique]
  }
}

Table sku_serial {
  id BigInt [pk, increment]
  serial_number String [unique, not null]
  sku_id BigInt [not null]
  status ProductStatus [not null]
  date_created DateTime [default: `now()`, not null]
}

Table stock {
  id BigInt [pk, increment]
  ref_type StockType [not null]
  ref_id BigInt [not null]
  current_stock BigInt [not null, default: 0]
  sold BigInt [not null, default: 0]
  date_created DateTime [default: `now()`, not null]

  indexes {
    (ref_id, ref_type) [unique]
  }
}

Table stock_history {
  id BigInt [pk, increment]
  stock_id BigInt [not null]
  change BigInt [not null]
  date_created DateTime [default: `now()`, not null]
}

Table order {
  id BigInt [pk, increment]
  code String [unique, not null]
  customer_id BigInt [not null]
  payment_method PaymentMethod [not null]
  status Status [not null]
  address String [not null]
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [not null]
}

Table order_item {
  id BigInt [pk, increment]
  code String [unique, not null]
  order_id BigInt [not null]
  sku_id BigInt [not null]
  quantity BigInt [not null]
}

Table order_item_serial {
  id BigInt [pk, increment]
  order_item_id BigInt [not null]
  product_serial_id BigInt [not null]

  indexes {
    (order_item_id, product_serial_id) [unique]
  }
}

Table vnpay {
  id BigInt [pk, increment]
  order_id BigInt [unique, not null]
  vnp_Amount String [not null]
  vnp_BankCode String [not null]
  vnp_CardType String [not null]
  vnp_OrderInfo String [not null]
  vnp_PayDate String [not null]
  vnp_ResponseCode String [not null]
  vnp_SecureHash String [not null]
  vnp_TmnCode String [not null]
  vnp_TransactionNo String [not null]
  vnp_TransactionStatus String [not null]
  vnp_TxnRef String [not null]
}

Table refund {
  id BigInt [pk, increment]
  code String [unique, not null]
  order_item_id BigInt [not null]
  reviewed_by_id BigInt
  method RefundMethod [not null]
  status Status [not null]
  reason String [not null]
  address String
  date_created DateTime [default: `now()`, not null]
}

Table refund_dispute {
  id BigInt [pk, increment]
  code String [unique, not null]
  refund_id BigInt [not null]
  vendor_id BigInt [not null]
  reason String [not null]
  status Status [not null, default: 'Pending']
  date_created DateTime [default: `now()`, not null]
  date_updated DateTime [not null]
}

Table invoice {
  id BigInt [pk, increment]
  code String [unique, not null]
  type InvoiceType [not null]
  ref_type InvoiceRefType [not null]
  ref_id BigInt [not null]
  seller_account_id BigInt
  buyer_account_id BigInt [not null]
  status Status [not null]
  payment_method PaymentMethod [not null]
  address String [not null]
  phone String [not null]
  subtotal BigInt [not null]
  total BigInt [not null]
  file_rs_id String [not null]
  date_created DateTime [default: `now()`, not null]
  hash Bytes [unique, not null]
  prev_hash Bytes
}

Table invoice_item {
  id BigInt [pk, increment]
  invoice_id BigInt [not null]
  snapshot Json [not null]
  quantity BigInt [not null]
  unit_price BigInt [not null]
  subtotal BigInt [not null]
  total BigInt [not null]
}

Table promotion {
  id BigInt [pk, increment]
  code String [unique, not null]
  type PromotionType [not null]
  is_active Boolean [not null, default: true]
  date_started DateTime [default: `now()`, not null]
  date_ended DateTime
  date_created DateTime [default: `now()`, not null]
}

Table promotion_voucher {
  id BigInt [pk, increment]
  promotion_id BigInt [unique, not null]
  min_spend BigInt [not null, default: 0]
  max_discount BigInt [not null, default: 0]
  discount_percent Int
  discount_price BigInt
}

Table promotion_redemption {
  id BigInt [pk, increment]
  promotion_id BigInt [not null]
  version BigInt [not null]
  ref_type PromotionRefType [not null]
  ref_id BigInt [not null]
  date_created DateTime [default: `now()`, not null]
}

Table resource {
  id BigInt [pk, increment]
  mime_type String [not null]
  owner_id BigInt [not null]
  owner_type ResourceType [not null]
  url String [not null]
  order Int [not null]
}

Table event {
  id BigInt [pk, increment]
  account_id BigInt
  aggregate_id BigInt [not null]
  aggregate_type String [not null]
  event_type EventType [not null]
  payload Json [not null]
  version BigInt [not null]
  date_created DateTime [default: `now()`, not null]
}

Table search_sync {
  id BigInt [pk, increment]
  name String [not null]
  last_synced DateTime [default: `now()`, not null]
}

Enum AccountType {
  Customer
  Vendor
}

Enum AccountStatus {
  ACTIVE
  SUSPENDED
}

Enum Gender {
  Male
  Female
  Other
}

Enum AddressType {
  HOME
  WORK
}

Enum CommentableType {
  ProductSPU
  Comment
}

Enum StockType {
  ProductSKU
  Promotion
}

Enum ProductStatus {
  Active
  Inactive
  Sold
  Damaged
}

Enum PaymentMethod {
  COD
  Card
  EWallet
  Crypto
}

Enum RefundMethod {
  PickUp
  DropOff
}

Enum InvoiceType {
  Sale
  Service
  Adjustment
}

Enum InvoiceRefType {
  Order
  Fee
}

Enum PromotionType {
  Voucher
  FlashSale
  Bundle
  BuyXGetY
  Cashback
}

Enum PromotionRefType {
  OrderItem
  Order
}

Enum ResourceType {
  Avatar
  ProductImage
  BrandLogo
  Refund
  ReturnDispute
}

Enum Status {
  Pending
  Processing
  Success
  Canceled
  Failed
}

Enum EventType {
  Created
  Updated
  Deleted
}

Ref: profile.account_id - account.id [delete: Cascade]

Ref: customer.account_id - account.id [delete: Cascade]

Ref: vendor.account_id - account.id [delete: Cascade]

Ref: cart_item.cart_id > customer.id [delete: Cascade]

Ref: cart_item.sku_id > product_sku.id [delete: Cascade]

Ref: address.account_id > account.id [delete: Cascade]

Ref: product_spu.account_id > vendor.id [delete: Cascade]

Ref: product_spu.category_id > category.id [delete: Cascade]

Ref: product_spu.brand_id > brand.id [delete: Cascade]

Ref: product_sku.spu_id > product_spu.id [delete: Cascade]

Ref: product_sku_attribute.sku_id > product_sku.id [delete: Cascade]

Ref: product_spu_tag.spu_id > product_spu.id [delete: Cascade]

Ref: product_spu_tag.tag_id > tag.id [delete: Cascade]

Ref: comment.account_id > customer.id [delete: Cascade]

Ref: sku_serial.sku_id > product_sku.id [delete: Cascade]

Ref: stock_history.stock_id > stock.id [delete: Cascade]

Ref: order.customer_id > customer.id [delete: Cascade]

Ref: order_item.order_id > order.id [delete: Cascade]

Ref: order_item.sku_id > product_sku.id [delete: Cascade]

Ref: order_item_serial.order_item_id > order_item.id [delete: Cascade]

Ref: order_item_serial.product_serial_id > sku_serial.id [delete: Cascade]

Ref: vnpay.order_id - order.id [delete: Cascade]

Ref: refund.order_item_id > order_item.id [delete: Cascade]

Ref: refund.reviewed_by_id > vendor.id [delete: Set Null]

Ref: refund_dispute.refund_id > refund.id [delete: Cascade]

Ref: refund_dispute.vendor_id > vendor.id [delete: Cascade]

Ref: invoice_item.invoice_id > invoice.id [delete: Cascade]

Ref: promotion_voucher.promotion_id > promotion.id [delete: Cascade]

Ref: promotion_redemption.promotion_id > promotion.id [delete: Cascade]

Ref: event.account_id > account.id [delete: Set Null]